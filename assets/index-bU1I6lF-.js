import{R as St}from"./kaplay-DTLyooHV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();const b=e=>typeof e=="string",te=()=>{let e,t;const i=new Promise((r,s)=>{e=r,t=s});return i.resolve=e,i.reject=t,i},Ke=e=>e==null?"":""+e,xt=(e,t,i)=>{e.forEach(r=>{t[r]&&(i[r]=t[r])})},vt=/###/g,Ve=e=>e&&e.indexOf("###")>-1?e.replace(vt,"."):e,Ge=e=>!e||b(e),se=(e,t,i)=>{const r=b(t)?t.split("."):t;let s=0;for(;s<r.length-1;){if(Ge(e))return{};const n=Ve(r[s]);!e[n]&&i&&(e[n]=new i),Object.prototype.hasOwnProperty.call(e,n)?e=e[n]:e={},++s}return Ge(e)?{}:{obj:e,k:Ve(r[s])}},Xe=(e,t,i)=>{const{obj:r,k:s}=se(e,t,Object);if(r!==void 0||t.length===1){r[s]=i;return}let n=t[t.length-1],o=t.slice(0,t.length-1),a=se(e,o,Object);for(;a.obj===void 0&&o.length;)n=`${o[o.length-1]}.${n}`,o=o.slice(0,o.length-1),a=se(e,o,Object),a?.obj&&typeof a.obj[`${a.k}.${n}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${n}`]=i},Lt=(e,t,i,r)=>{const{obj:s,k:n}=se(e,t,Object);s[n]=s[n]||[],s[n].push(i)},le=(e,t)=>{const{obj:i,k:r}=se(e,t);if(i&&Object.prototype.hasOwnProperty.call(i,r))return i[r]},Ot=(e,t,i)=>{const r=le(e,i);return r!==void 0?r:le(t,i)},ht=(e,t,i)=>{for(const r in t)r!=="__proto__"&&r!=="constructor"&&(r in e?b(e[r])||e[r]instanceof String||b(t[r])||t[r]instanceof String?i&&(e[r]=t[r]):ht(e[r],t[r],i):e[r]=t[r]);return e},X=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var It={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Pt=e=>b(e)?e.replace(/[&<>"'\/]/g,t=>It[t]):e;class Rt{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const i=this.regExpMap.get(t);if(i!==void 0)return i;const r=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,r),this.regExpQueue.push(t),r}}const Et=[" ",",","?","!",";"],Ct=new Rt(20),Tt=(e,t,i)=>{t=t||"",i=i||"";const r=Et.filter(o=>t.indexOf(o)<0&&i.indexOf(o)<0);if(r.length===0)return!0;const s=Ct.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let n=!s.test(e);if(!n){const o=e.indexOf(i);o>0&&!s.test(e.substring(0,o))&&(n=!0)}return n},Oe=(e,t,i=".")=>{if(!e)return;if(e[t])return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;const r=t.split(i);let s=e;for(let n=0;n<r.length;){if(!s||typeof s!="object")return;let o,a="";for(let l=n;l<r.length;++l)if(l!==n&&(a+=i),a+=r[l],o=s[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;n+=l-n+1;break}s=o}return s},ie=e=>e?.replace("_","-"),At={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class ce{constructor(t,i={}){this.init(t,i)}init(t,i={}){this.prefix=i.prefix||"i18next:",this.logger=t||At,this.options=i,this.debug=i.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,i,r,s){return s&&!this.debug?null:(b(t[0])&&(t[0]=`${r}${this.prefix} ${t[0]}`),this.logger[i](t))}create(t){return new ce(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new ce(this.logger,t)}}var j=new ce;class me{constructor(){this.observers={}}on(t,i){return t.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const s=this.observers[r].get(i)||0;this.observers[r].set(i,s+1)}),this}off(t,i){if(this.observers[t]){if(!i){delete this.observers[t];return}this.observers[t].delete(i)}}emit(t,...i){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([s,n])=>{for(let o=0;o<n;o++)s(...i)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,n])=>{for(let o=0;o<n;o++)s.apply(s,[t,...i])})}}class We extends me{constructor(t,i={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const i=this.options.ns.indexOf(t);i>-1&&this.options.ns.splice(i,1)}getResource(t,i,r,s={}){const n=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;t.indexOf(".")>-1?a=t.split("."):(a=[t,i],r&&(Array.isArray(r)?a.push(...r):b(r)&&n?a.push(...r.split(n)):a.push(r)));const l=le(this.data,a);return!l&&!i&&!r&&t.indexOf(".")>-1&&(t=a[0],i=a[1],r=a.slice(2).join(".")),l||!o||!b(r)?l:Oe(this.data?.[t]?.[i],r,n)}addResource(t,i,r,s,n={silent:!1}){const o=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let a=[t,i];r&&(a=a.concat(o?r.split(o):r)),t.indexOf(".")>-1&&(a=t.split("."),s=i,i=a[1]),this.addNamespaces(i),Xe(this.data,a,s),n.silent||this.emit("added",t,i,r,s)}addResources(t,i,r,s={silent:!1}){for(const n in r)(b(r[n])||Array.isArray(r[n]))&&this.addResource(t,i,n,r[n],{silent:!0});s.silent||this.emit("added",t,i,r)}addResourceBundle(t,i,r,s,n,o={silent:!1,skipCopy:!1}){let a=[t,i];t.indexOf(".")>-1&&(a=t.split("."),s=r,r=i,i=a[1]),this.addNamespaces(i);let l=le(this.data,a)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),s?ht(l,r,n):l={...l,...r},Xe(this.data,a,l),o.silent||this.emit("added",t,i,r)}removeResourceBundle(t,i){this.hasResourceBundle(t,i)&&delete this.data[t][i],this.removeNamespaces(i),this.emit("removed",t,i)}hasResourceBundle(t,i){return this.getResource(t,i)!==void 0}getResourceBundle(t,i){return i||(i=this.options.defaultNS),this.getResource(t,i)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const i=this.getDataByLanguage(t);return!!(i&&Object.keys(i)||[]).find(s=>i[s]&&Object.keys(i[s]).length>0)}toJSON(){return this.data}}var pt={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,i,r,s){return e.forEach(n=>{t=this.processors[n]?.process(t,i,r,s)??t}),t}};const ze={},Ye=e=>!b(e)&&typeof e!="boolean"&&typeof e!="number";class ue extends me{constructor(t,i={}){super(),xt(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=i,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=j.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,i={interpolation:{}}){const r={...i};return t==null?!1:this.resolve(t,r)?.res!==void 0}extractFromKey(t,i){let r=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let n=i.ns||this.options.defaultNS||[];const o=r&&t.indexOf(r)>-1,a=!this.options.userDefinedKeySeparator&&!i.keySeparator&&!this.options.userDefinedNsSeparator&&!i.nsSeparator&&!Tt(t,r,s);if(o&&!a){const l=t.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:t,namespaces:b(n)?[n]:n};const c=t.split(r);(r!==s||r===s&&this.options.ns.indexOf(c[0])>-1)&&(n=c.shift()),t=c.join(s)}return{key:t,namespaces:b(n)?[n]:n}}translate(t,i,r){let s=typeof i=="object"?{...i}:i;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(s={...s}),s||(s={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const n=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:a,namespaces:l}=this.extractFromKey(t[t.length-1],s),c=l[l.length-1];let d=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const u=s.lng||this.language,g=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u?.toLowerCase()==="cimode")return g?n?{res:`${c}${d}${a}`,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:`${c}${d}${a}`:n?{res:a,usedKey:a,exactUsedKey:a,usedLng:u,usedNS:c,usedParams:this.getUsedParamsDetails(s)}:a;const p=this.resolve(t,s);let h=p?.res;const y=p?.usedKey||a,v=p?.exactUsedKey||a,f=["[object Number]","[object Function]","[object RegExp]"],m=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,S=!this.i18nFormat||this.i18nFormat.handleAsObject,O=s.count!==void 0&&!b(s.count),L=ue.hasDefaultValue(s),M=O?this.pluralResolver.getSuffix(u,s.count,s):"",K=s.ordinal&&O?this.pluralResolver.getSuffix(u,s.count,{ordinal:!1}):"",ne=O&&!s.ordinal&&s.count===0,N=ne&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${M}`]||s[`defaultValue${K}`]||s.defaultValue;let A=h;S&&!h&&L&&(A=N);const we=Ye(A),Se=Object.prototype.toString.apply(A);if(S&&A&&we&&f.indexOf(Se)<0&&!(b(m)&&Array.isArray(A))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const F=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,A,{...s,ns:l}):`key '${a} (${this.language})' returned an object instead of string.`;return n?(p.res=F,p.usedParams=this.getUsedParamsDetails(s),p):F}if(o){const F=Array.isArray(A),D=F?[]:{},Be=F?v:y;for(const $ in A)if(Object.prototype.hasOwnProperty.call(A,$)){const H=`${Be}${o}${$}`;L&&!h?D[$]=this.translate(H,{...s,defaultValue:Ye(N)?N[$]:void 0,joinArrays:!1,ns:l}):D[$]=this.translate(H,{...s,joinArrays:!1,ns:l}),D[$]===H&&(D[$]=A[$])}h=D}}else if(S&&b(m)&&Array.isArray(h))h=h.join(m),h&&(h=this.extendTranslation(h,t,s,r));else{let F=!1,D=!1;!this.isValidLookup(h)&&L&&(F=!0,h=N),this.isValidLookup(h)||(D=!0,h=a);const $=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&D?void 0:h,H=L&&N!==h&&this.options.updateMissing;if(D||F||H){if(this.logger.log(H?"updateKey":"missingKey",u,c,a,H?N:h),o){const C=this.resolve(a,{...s,keySeparator:!1});C&&C.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let k=[];const ae=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ae&&ae[0])for(let C=0;C<ae.length;C++)k.push(ae[C]);else this.options.saveMissingTo==="all"?k=this.languageUtils.toResolveHierarchy(s.lng||this.language):k.push(s.lng||this.language);const Ue=(C,V,ee)=>{const _e=L&&ee!==h?ee:$;this.options.missingKeyHandler?this.options.missingKeyHandler(C,c,V,_e,H,s):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(C,c,V,_e,H,s),this.emit("missingKey",C,c,V,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&O?k.forEach(C=>{const V=this.pluralResolver.getSuffixes(C,s);ne&&s[`defaultValue${this.options.pluralSeparator}zero`]&&V.indexOf(`${this.options.pluralSeparator}zero`)<0&&V.push(`${this.options.pluralSeparator}zero`),V.forEach(ee=>{Ue([C],a+ee,s[`defaultValue${ee}`]||N)})}):Ue(k,a,N))}h=this.extendTranslation(h,t,s,p,r),D&&h===a&&this.options.appendNamespaceToMissingKey&&(h=`${c}${d}${a}`),(D||F)&&this.options.parseMissingKeyHandler&&(h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${d}${a}`:a,F?h:void 0,s))}return n?(p.res=h,p.usedParams=this.getUsedParamsDetails(s),p):h}extendTranslation(t,i,r,s,n){if(this.i18nFormat?.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const l=b(t)&&(r?.interpolation?.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(l){const u=t.match(this.interpolator.nestingRegexp);c=u&&u.length}let d=r.replace&&!b(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),t=this.interpolator.interpolate(t,d,r.lng||this.language||s.usedLng,r),l){const u=t.match(this.interpolator.nestingRegexp),g=u&&u.length;c<g&&(r.nest=!1)}!r.lng&&s&&s.res&&(r.lng=this.language||s.usedLng),r.nest!==!1&&(t=this.interpolator.nest(t,(...u)=>n?.[0]===u[0]&&!r.context?(this.logger.warn(`It seems you are nesting recursively key: ${u[0]} in key: ${i[0]}`),null):this.translate(...u,i),r)),r.interpolation&&this.interpolator.reset()}const o=r.postProcess||this.options.postProcess,a=b(o)?[o]:o;return t!=null&&a?.length&&r.applyPostProcessor!==!1&&(t=pt.handle(a,t,i,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),t}resolve(t,i={}){let r,s,n,o,a;return b(t)&&(t=[t]),t.forEach(l=>{if(this.isValidLookup(r))return;const c=this.extractFromKey(l,i),d=c.key;s=d;let u=c.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const g=i.count!==void 0&&!b(i.count),p=g&&!i.ordinal&&i.count===0,h=i.context!==void 0&&(b(i.context)||typeof i.context=="number")&&i.context!=="",y=i.lngs?i.lngs:this.languageUtils.toResolveHierarchy(i.lng||this.language,i.fallbackLng);u.forEach(v=>{this.isValidLookup(r)||(a=v,!ze[`${y[0]}-${v}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(a)&&(ze[`${y[0]}-${v}`]=!0,this.logger.warn(`key "${s}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(f=>{if(this.isValidLookup(r))return;o=f;const m=[d];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(m,d,f,v,i);else{let O;g&&(O=this.pluralResolver.getSuffix(f,i.count,i));const L=`${this.options.pluralSeparator}zero`,M=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(g&&(m.push(d+O),i.ordinal&&O.indexOf(M)===0&&m.push(d+O.replace(M,this.options.pluralSeparator)),p&&m.push(d+L)),h){const K=`${d}${this.options.contextSeparator}${i.context}`;m.push(K),g&&(m.push(K+O),i.ordinal&&O.indexOf(M)===0&&m.push(K+O.replace(M,this.options.pluralSeparator)),p&&m.push(K+L))}}let S;for(;S=m.pop();)this.isValidLookup(r)||(n=S,r=this.getResource(f,v,S,i))}))})}),{res:r,usedKey:s,exactUsedKey:n,usedLng:o,usedNS:a}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,i,r,s={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(t,i,r,s):this.resourceStore.getResource(t,i,r,s)}getUsedParamsDetails(t={}){const i=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=t.replace&&!b(t.replace);let s=r?t.replace:t;if(r&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!r){s={...s};for(const n of i)delete s[n]}return s}static hasDefaultValue(t){const i="defaultValue";for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&i===r.substring(0,i.length)&&t[r]!==void 0)return!0;return!1}}class Je{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=j.create("languageUtils")}getScriptPartFromCode(t){if(t=ie(t),!t||t.indexOf("-")<0)return null;const i=t.split("-");return i.length===2||(i.pop(),i[i.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(i.join("-"))}getLanguagePartFromCode(t){if(t=ie(t),!t||t.indexOf("-")<0)return t;const i=t.split("-");return this.formatLanguageCode(i[0])}formatLanguageCode(t){if(b(t)&&t.indexOf("-")>-1){let i;try{i=Intl.getCanonicalLocales(t)[0]}catch{}return i&&this.options.lowerCaseLng&&(i=i.toLowerCase()),i||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let i;return t.forEach(r=>{if(i)return;const s=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(s))&&(i=s)}),!i&&this.options.supportedLngs&&t.forEach(r=>{if(i)return;const s=this.getScriptPartFromCode(r);if(this.isSupportedCode(s))return i=s;const n=this.getLanguagePartFromCode(r);if(this.isSupportedCode(n))return i=n;i=this.options.supportedLngs.find(o=>{if(o===n)return o;if(!(o.indexOf("-")<0&&n.indexOf("-")<0)&&(o.indexOf("-")>0&&n.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===n||o.indexOf(n)===0&&n.length>1))return o})}),i||(i=this.getFallbackCodes(this.options.fallbackLng)[0]),i}getFallbackCodes(t,i){if(!t)return[];if(typeof t=="function"&&(t=t(i)),b(t)&&(t=[t]),Array.isArray(t))return t;if(!i)return t.default||[];let r=t[i];return r||(r=t[this.getScriptPartFromCode(i)]),r||(r=t[this.formatLanguageCode(i)]),r||(r=t[this.getLanguagePartFromCode(i)]),r||(r=t.default),r||[]}toResolveHierarchy(t,i){const r=this.getFallbackCodes((i===!1?[]:i)||this.options.fallbackLng||[],t),s=[],n=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return b(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&n(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&n(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&n(this.getLanguagePartFromCode(t))):b(t)&&n(this.formatLanguageCode(t)),r.forEach(o=>{s.indexOf(o)<0&&n(this.formatLanguageCode(o))}),s}}const qe={zero:0,one:1,two:2,few:3,many:4,other:5},Qe={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class Dt{constructor(t,i={}){this.languageUtils=t,this.options=i,this.logger=j.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,i){this.rules[t]=i}clearCache(){this.pluralRulesCache={}}getRule(t,i={}){const r=ie(t==="dev"?"en":t),s=i.ordinal?"ordinal":"cardinal",n=JSON.stringify({cleanedCode:r,type:s});if(n in this.pluralRulesCache)return this.pluralRulesCache[n];let o;try{o=new Intl.PluralRules(r,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Qe;if(!t.match(/-|_/))return Qe;const l=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(l,i)}return this.pluralRulesCache[n]=o,o}needsPlural(t,i={}){let r=this.getRule(t,i);return r||(r=this.getRule("dev",i)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(t,i,r={}){return this.getSuffixes(t,r).map(s=>`${i}${s}`)}getSuffixes(t,i={}){let r=this.getRule(t,i);return r||(r=this.getRule("dev",i)),r?r.resolvedOptions().pluralCategories.sort((s,n)=>qe[s]-qe[n]).map(s=>`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(t,i,r={}){const s=this.getRule(t,r);return s?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s.select(i)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",i,r))}}const Ze=(e,t,i,r=".",s=!0)=>{let n=Ot(e,t,i);return!n&&s&&b(i)&&(n=Oe(e,i,r),n===void 0&&(n=Oe(t,i,r))),n},xe=e=>e.replace(/\$/g,"$$$$");class Mt{constructor(t={}){this.logger=j.create("interpolator"),this.options=t,this.format=t?.interpolation?.format||(i=>i),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:i,escapeValue:r,useRawValueToEscape:s,prefix:n,prefixEscaped:o,suffix:a,suffixEscaped:l,formatSeparator:c,unescapeSuffix:d,unescapePrefix:u,nestingPrefix:g,nestingPrefixEscaped:p,nestingSuffix:h,nestingSuffixEscaped:y,nestingOptionsSeparator:v,maxReplaces:f,alwaysFormat:m}=t.interpolation;this.escape=i!==void 0?i:Pt,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=n?X(n):o||"{{",this.suffix=a?X(a):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=d?"":u||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=g?X(g):p||X("$t("),this.nestingSuffix=h?X(h):y||X(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=f||1e3,this.alwaysFormat=m!==void 0?m:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(i,r)=>i?.source===r?(i.lastIndex=0,i):new RegExp(r,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,i,r,s){let n,o,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=p=>{if(p.indexOf(this.formatSeparator)<0){const f=Ze(i,l,p,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(f,void 0,r,{...s,...i,interpolationkey:p}):f}const h=p.split(this.formatSeparator),y=h.shift().trim(),v=h.join(this.formatSeparator).trim();return this.format(Ze(i,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),v,r,{...s,...i,interpolationkey:y})};this.resetRegExp();const d=s?.missingInterpolationHandler||this.options.missingInterpolationHandler,u=s?.interpolation?.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:p=>xe(p)},{regex:this.regexp,safeValue:p=>this.escapeValue?xe(this.escape(p)):xe(p)}].forEach(p=>{for(a=0;n=p.regex.exec(t);){const h=n[1].trim();if(o=c(h),o===void 0)if(typeof d=="function"){const v=d(t,n,s);o=b(v)?v:""}else if(s&&Object.prototype.hasOwnProperty.call(s,h))o="";else if(u){o=n[0];continue}else this.logger.warn(`missed to pass in variable ${h} for interpolating ${t}`),o="";else!b(o)&&!this.useRawValueToEscape&&(o=Ke(o));const y=p.safeValue(o);if(t=t.replace(n[0],y),u?(p.regex.lastIndex+=o.length,p.regex.lastIndex-=n[0].length):p.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),t}nest(t,i,r={}){let s,n,o;const a=(l,c)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const u=l.split(new RegExp(`${d}[ ]*{`));let g=`{${u[1]}`;l=u[0],g=this.interpolate(g,o);const p=g.match(/'/g),h=g.match(/"/g);((p?.length??0)%2===0&&!h||h.length%2!==0)&&(g=g.replace(/'/g,'"'));try{o=JSON.parse(g),c&&(o={...c,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${d}${g}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;s=this.nestingRegexp.exec(t);){let l=[];o={...r},o=o.replace&&!b(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const c=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(c!==-1&&(l=s[1].slice(c).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),s[1]=s[1].slice(0,c)),n=i(a.call(this,s[1].trim(),o),o),n&&s[0]===t&&!b(n))return n;b(n)||(n=Ke(n)),n||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),n=""),l.length&&(n=l.reduce((d,u)=>this.format(d,u,r.lng,{...r,interpolationkey:s[1].trim()}),n.trim())),t=t.replace(s[0],n),this.regexp.lastIndex=0}return t}}const Nt=e=>{let t=e.toLowerCase().trim();const i={};if(e.indexOf("(")>-1){const r=e.split("(");t=r[0].toLowerCase().trim();const s=r[1].substring(0,r[1].length-1);t==="currency"&&s.indexOf(":")<0?i.currency||(i.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?i.range||(i.range=s.trim()):s.split(";").forEach(o=>{if(o){const[a,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),d=a.trim();i[d]||(i[d]=c),c==="false"&&(i[d]=!1),c==="true"&&(i[d]=!0),isNaN(c)||(i[d]=parseInt(c,10))}})}return{formatName:t,formatOptions:i}},ke=e=>{const t={};return(i,r,s)=>{let n=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(n={...n,[s.interpolationkey]:void 0});const o=r+JSON.stringify(n);let a=t[o];return a||(a=e(ie(r),s),t[o]=a),a(i)}},Ft=e=>(t,i,r)=>e(ie(i),r)(t);class $t{constructor(t={}){this.logger=j.create("formatter"),this.options=t,this.init(t)}init(t,i={interpolation:{}}){this.formatSeparator=i.interpolation.formatSeparator||",";const r=i.cacheInBuiltFormats?ke:Ft;this.formats={number:r((s,n)=>{const o=new Intl.NumberFormat(s,{...n});return a=>o.format(a)}),currency:r((s,n)=>{const o=new Intl.NumberFormat(s,{...n,style:"currency"});return a=>o.format(a)}),datetime:r((s,n)=>{const o=new Intl.DateTimeFormat(s,{...n});return a=>o.format(a)}),relativetime:r((s,n)=>{const o=new Intl.RelativeTimeFormat(s,{...n});return a=>o.format(a,n.range||"day")}),list:r((s,n)=>{const o=new Intl.ListFormat(s,{...n});return a=>o.format(a)})}}add(t,i){this.formats[t.toLowerCase().trim()]=i}addCached(t,i){this.formats[t.toLowerCase().trim()]=ke(i)}format(t,i,r,s={}){const n=i.split(this.formatSeparator);if(n.length>1&&n[0].indexOf("(")>1&&n[0].indexOf(")")<0&&n.find(a=>a.indexOf(")")>-1)){const a=n.findIndex(l=>l.indexOf(")")>-1);n[0]=[n[0],...n.splice(1,a)].join(this.formatSeparator)}return n.reduce((a,l)=>{const{formatName:c,formatOptions:d}=Nt(l);if(this.formats[c]){let u=a;try{const g=s?.formatParams?.[s.interpolationkey]||{},p=g.locale||g.lng||s.locale||s.lng||r;u=this.formats[c](a,p,{...d,...s,...g})}catch(g){this.logger.warn(g)}return u}else this.logger.warn(`there was no format function for ${c}`);return a},t)}}const jt=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Ht extends me{constructor(t,i,r,s={}){super(),this.backend=t,this.store=i,this.services=r,this.languageUtils=r.languageUtils,this.options=s,this.logger=j.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,s.backend,s)}queueLoad(t,i,r,s){const n={},o={},a={},l={};return t.forEach(c=>{let d=!0;i.forEach(u=>{const g=`${c}|${u}`;!r.reload&&this.store.hasResourceBundle(c,u)?this.state[g]=2:this.state[g]<0||(this.state[g]===1?o[g]===void 0&&(o[g]=!0):(this.state[g]=1,d=!1,o[g]===void 0&&(o[g]=!0),n[g]===void 0&&(n[g]=!0),l[u]===void 0&&(l[u]=!0)))}),d||(a[c]=!0)}),(Object.keys(n).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(n),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(t,i,r){const s=t.split("|"),n=s[0],o=s[1];i&&this.emit("failedLoading",n,o,i),!i&&r&&this.store.addResourceBundle(n,o,r,void 0,void 0,{skipCopy:!0}),this.state[t]=i?-1:2,i&&r&&(this.state[t]=0);const a={};this.queue.forEach(l=>{Lt(l.loaded,[n],o),jt(l,t),i&&l.errors.push(i),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{a[c]||(a[c]={});const d=l.loaded[c];d.length&&d.forEach(u=>{a[c][u]===void 0&&(a[c][u]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(t,i,r,s=0,n=this.retryTimeout,o){if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:i,fcName:r,tried:s,wait:n,callback:o});return}this.readingCalls++;const a=(c,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const u=this.waitingReads.shift();this.read(u.lng,u.ns,u.fcName,u.tried,u.wait,u.callback)}if(c&&d&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,i,r,s+1,n*2,o)},n);return}o(c,d)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const c=l(t,i);c&&typeof c.then=="function"?c.then(d=>a(null,d)).catch(a):a(null,c)}catch(c){a(c)}return}return l(t,i,a)}prepareLoading(t,i,r={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();b(t)&&(t=this.languageUtils.toResolveHierarchy(t)),b(i)&&(i=[i]);const n=this.queueLoad(t,i,r,s);if(!n.toLoad.length)return n.pending.length||s(),null;n.toLoad.forEach(o=>{this.loadOne(o)})}load(t,i,r){this.prepareLoading(t,i,{},r)}reload(t,i,r){this.prepareLoading(t,i,{reload:!0},r)}loadOne(t,i=""){const r=t.split("|"),s=r[0],n=r[1];this.read(s,n,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${i}loading namespace ${n} for language ${s} failed`,o),!o&&a&&this.logger.log(`${i}loaded namespace ${n} for language ${s}`,a),this.loaded(t,o,a)})}saveMissing(t,i,r,s,n,o={},a=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(i)){this.logger.warn(`did not save key "${r}" as the namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend?.create){const l={...o,isUpdate:n},c=this.backend.create.bind(this.backend);if(c.length<6)try{let d;c.length===5?d=c(t,i,r,s,l):d=c(t,i,r,s),d&&typeof d.then=="function"?d.then(u=>a(null,u)).catch(a):a(null,d)}catch(d){a(d)}else c(t,i,r,s,a,l)}!t||!t[0]||this.store.addResource(t[0],i,r,s)}}}const et=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),b(e[1])&&(t.defaultValue=e[1]),b(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const i=e[3]||e[2];Object.keys(i).forEach(r=>{t[r]=i[r]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),tt=e=>(b(e.ns)&&(e.ns=[e.ns]),b(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),b(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e),oe=()=>{},Bt=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(i=>{typeof e[i]=="function"&&(e[i]=e[i].bind(e))})};class re extends me{constructor(t={},i){if(super(),this.options=tt(t),this.services={},this.logger=j,this.modules={external:[]},Bt(this),i&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,i),this;setTimeout(()=>{this.init(t,i)},0)}}init(t={},i){this.isInitializing=!0,typeof t=="function"&&(i=t,t={}),t.defaultNS==null&&t.ns&&(b(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=et();this.options={...r,...this.options,...tt(t)},this.options.interpolation={...r.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const s=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?j.init(s(this.modules.logger),this.options):j.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=$t;const d=new Je(this.options);this.store=new We(this.options.resources,this.options);const u=this.services;u.logger=j,u.resourceStore=this.store,u.languageUtils=d,u.pluralResolver=new Dt(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.warn("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),c&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(u.formatter=s(c),u.formatter.init&&u.formatter.init(u,this.options),this.options.interpolation.format=u.formatter.format.bind(u.formatter)),u.interpolator=new Mt(this.options),u.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},u.backendConnector=new Ht(s(this.modules.backend),u.resourceStore,u,this.options),u.backendConnector.on("*",(p,...h)=>{this.emit(p,...h)}),this.modules.languageDetector&&(u.languageDetector=s(this.modules.languageDetector),u.languageDetector.init&&u.languageDetector.init(u,this.options.detection,this.options)),this.modules.i18nFormat&&(u.i18nFormat=s(this.modules.i18nFormat),u.i18nFormat.init&&u.i18nFormat.init(this)),this.translator=new ue(this.services,this.options),this.translator.on("*",(p,...h)=>{this.emit(p,...h)}),this.modules.external.forEach(p=>{p.init&&p.init(this)})}if(this.format=this.options.interpolation.format,i||(i=oe),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=(...d)=>this.store[c](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=(...d)=>(this.store[c](...d),this)});const a=te(),l=()=>{const c=(d,u)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(u),i(d,u)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),a}loadResources(t,i=oe){let r=i;const s=b(t)?t:this.language;if(typeof t=="function"&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(s?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const n=[],o=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(c=>{c!=="cimode"&&n.indexOf(c)<0&&n.push(c)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>o(l)),this.options.preload?.forEach?.(a=>o(a)),this.services.backendConnector.load(n,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(a)})}else r(null)}reloadResources(t,i,r){const s=te();return typeof t=="function"&&(r=t,t=void 0),typeof i=="function"&&(r=i,i=void 0),t||(t=this.languages),i||(i=this.options.ns),r||(r=oe),this.services.backendConnector.reload(t,i,n=>{s.resolve(),r(n)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&pt.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let i=0;i<this.languages.length;i++){const r=this.languages[i];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,i){this.isLanguageChangingTo=t;const r=te();this.emit("languageChanging",t);const s=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},n=(a,l)=>{l?this.isLanguageChangingTo===t&&(s(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,r.resolve((...c)=>this.t(...c)),i&&i(a,(...c)=>this.t(...c))},o=a=>{!t&&!a&&this.services.languageDetector&&(a=[]);const l=b(a)?a:a&&a[0],c=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(b(a)?[a]:a);c&&(this.language||s(c),this.translator.language||this.translator.changeLanguage(c),this.services.languageDetector?.cacheUserLanguage?.(c)),this.loadResources(c,d=>{n(d,c)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),r}getFixedT(t,i,r){const s=(n,o,...a)=>{let l;typeof o!="object"?l=this.options.overloadTranslationOptionHandler([n,o].concat(a)):l={...o},l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||r||s.keyPrefix);const c=this.options.keySeparator||".";let d;return l.keyPrefix&&Array.isArray(n)?d=n.map(u=>`${l.keyPrefix}${c}${u}`):d=l.keyPrefix?`${l.keyPrefix}${c}${n}`:n,this.t(d,l)};return b(t)?s.lng=t:s.lngs=t,s.ns=i,s.keyPrefix=r,s}t(...t){return this.translator?.translate(...t)}exists(...t){return this.translator?.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,i={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=i.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,n=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(a,l)=>{const c=this.services.backendConnector.state[`${a}|${l}`];return c===-1||c===0||c===2};if(i.precheck){const a=i.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,t)&&(!s||o(n,t)))}loadNamespaces(t,i){const r=te();return this.options.ns?(b(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{r.resolve(),i&&i(s)}),r):(i&&i(),Promise.resolve())}loadLanguages(t,i){const r=te();b(t)&&(t=[t]);const s=this.options.preload||[],n=t.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return n.length?(this.options.preload=s.concat(n),this.loadResources(o=>{r.resolve(),i&&i(o)}),r):(i&&i(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!t)return"rtl";try{const s=new Intl.Locale(t);if(s&&s.getTextInfo){const n=s.getTextInfo();if(n&&n.direction)return n.direction}}catch{}const i=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services?.languageUtils||new Je(et());return t.toLowerCase().indexOf("-latn")>1?"ltr":i.indexOf(r.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},i){return new re(t,i)}cloneInstance(t={},i=oe){const r=t.forkResourceStore;r&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},n=new re(s);if((t.debug!==void 0||t.prefix!==void 0)&&(n.logger=n.logger.clone(t)),["store","services","language"].forEach(a=>{n[a]=this[a]}),n.services={...this.services},n.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},r){const a=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},l[c]=Object.keys(l[c]).reduce((d,u)=>(d[u]={...l[c][u]},d),l[c]),l),{});n.store=new We(a,s),n.services.resourceStore=n.store}return n.translator=new ue(n.services,s),n.translator.on("*",(a,...l)=>{n.emit(a,...l)}),n.init(s,i),n.translator.options=s,n.translator.backendConnector.services.utils={hasLoadedNamespace:n.hasLoadedNamespace.bind(n)},n}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const P=re.createInstance();P.createInstance=re.createInstance;P.createInstance;P.dir;P.init;P.loadResources;P.reloadResources;P.use;P.changeLanguage;P.getFixedT;const I=P.t;P.exists;P.setDefaultNamespace;P.hasLoadedNamespace;P.loadNamespaces;P.loadLanguages;const{slice:Ut,forEach:_t}=[];function Kt(e){return _t.call(Ut.call(arguments,1),t=>{if(t)for(const i in t)e[i]===void 0&&(e[i]=t[i])}),e}function Vt(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(i=>i.test(e))}const st=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Gt=function(e,t){const r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(t);let n=`${e}=${s}`;if(r.maxAge>0){const o=r.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");n+=`; Max-Age=${Math.floor(o)}`}if(r.domain){if(!st.test(r.domain))throw new TypeError("option domain is invalid");n+=`; Domain=${r.domain}`}if(r.path){if(!st.test(r.path))throw new TypeError("option path is invalid");n+=`; Path=${r.path}`}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");n+=`; Expires=${r.expires.toUTCString()}`}if(r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return r.partitioned&&(n+="; Partitioned"),n},it={create(e,t,i,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};i&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+i*60*1e3)),r&&(s.domain=r),document.cookie=Gt(e,t,s)},read(e){const t=`${e}=`,i=document.cookie.split(";");for(let r=0;r<i.length;r++){let s=i[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null},remove(e,t){this.create(e,"",-1,t)}};var Xt={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&typeof document<"u")return it.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:i,cookieMinutes:r,cookieDomain:s,cookieOptions:n}=t;i&&typeof document<"u"&&it.create(i,e,r,s,n)}},Wt={name:"querystring",lookup(e){let{lookupQuerystring:t}=e,i;if(typeof window<"u"){let{search:r}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(r=window.location.hash.substring(window.location.hash.indexOf("?")));const n=r.substring(1).split("&");for(let o=0;o<n.length;o++){const a=n[o].indexOf("=");a>0&&n[o].substring(0,a)===t&&(i=n[o].substring(a+1))}}return i}},zt={name:"hash",lookup(e){let{lookupHash:t,lookupFromHashIndex:i}=e,r;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const n=s.substring(1);if(t){const o=n.split("&");for(let a=0;a<o.length;a++){const l=o[a].indexOf("=");l>0&&o[a].substring(0,l)===t&&(r=o[a].substring(l+1))}}if(r)return r;if(!r&&i>-1){const o=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?o[typeof i=="number"?i:0]?.replace("/",""):void 0}}}return r}};let W=null;const rt=()=>{if(W!==null)return W;try{if(W=typeof window<"u"&&window.localStorage!==null,!W)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{W=!1}return W};var Yt={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&rt())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:i}=t;i&&rt()&&window.localStorage.setItem(i,e)}};let z=null;const nt=()=>{if(z!==null)return z;try{if(z=typeof window<"u"&&window.sessionStorage!==null,!z)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{z=!1}return z};var Jt={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&nt())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:i}=t;i&&nt()&&window.sessionStorage.setItem(i,e)}},qt={name:"navigator",lookup(e){const t=[];if(typeof navigator<"u"){const{languages:i,userLanguage:r,language:s}=navigator;if(i)for(let n=0;n<i.length;n++)t.push(i[n]);r&&t.push(r),s&&t.push(s)}return t.length>0?t:void 0}},Qt={name:"htmlTag",lookup(e){let{htmlTag:t}=e,i;const r=t||(typeof document<"u"?document.documentElement:null);return r&&typeof r.getAttribute=="function"&&(i=r.getAttribute("lang")),i}},Zt={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if(typeof window>"u")return;const i=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(i)?i[typeof t=="number"?t:0]?.replace("/",""):void 0}},kt={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e;const i=typeof t=="number"?t+1:1,r=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(r)return r[i]}};let ft=!1;try{document.cookie,ft=!0}catch{}const gt=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];ft||gt.splice(1,1);const es=()=>({order:gt,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class mt{constructor(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,i)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=Kt(i,this.options||{},es()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=r,this.addDetector(Xt),this.addDetector(Wt),this.addDetector(Yt),this.addDetector(Jt),this.addDetector(qt),this.addDetector(Qt),this.addDetector(Zt),this.addDetector(kt),this.addDetector(zt)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,i=[];return t.forEach(r=>{if(this.detectors[r]){let s=this.detectors[r].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(i=i.concat(s))}}),i=i.filter(r=>r!=null&&!Vt(r)).map(r=>this.options.convertDetectedLanguage(r)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?i:i.length>0?i[0]:null}cacheUserLanguage(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;i&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||i.forEach(r=>{this.detectors[r]&&this.detectors[r].cacheUserLanguage(t,this.options)}))}}mt.type="languageDetector";function ts(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ve,at;function ss(){if(at)return ve;at=1;var e=function(m){return t(m)&&!i(m)};function t(f){return!!f&&typeof f=="object"}function i(f){var m=Object.prototype.toString.call(f);return m==="[object RegExp]"||m==="[object Date]"||n(f)}var r=typeof Symbol=="function"&&Symbol.for,s=r?Symbol.for("react.element"):60103;function n(f){return f.$$typeof===s}function o(f){return Array.isArray(f)?[]:{}}function a(f,m){return m.clone!==!1&&m.isMergeableObject(f)?y(o(f),f,m):f}function l(f,m,S){return f.concat(m).map(function(O){return a(O,S)})}function c(f,m){if(!m.customMerge)return y;var S=m.customMerge(f);return typeof S=="function"?S:y}function d(f){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(f).filter(function(m){return Object.propertyIsEnumerable.call(f,m)}):[]}function u(f){return Object.keys(f).concat(d(f))}function g(f,m){try{return m in f}catch{return!1}}function p(f,m){return g(f,m)&&!(Object.hasOwnProperty.call(f,m)&&Object.propertyIsEnumerable.call(f,m))}function h(f,m,S){var O={};return S.isMergeableObject(f)&&u(f).forEach(function(L){O[L]=a(f[L],S)}),u(m).forEach(function(L){p(f,L)||(g(f,L)&&S.isMergeableObject(m[L])?O[L]=c(L,S)(f[L],m[L],S):O[L]=a(m[L],S))}),O}function y(f,m,S){S=S||{},S.arrayMerge=S.arrayMerge||l,S.isMergeableObject=S.isMergeableObject||e,S.cloneUnlessOtherwiseSpecified=a;var O=Array.isArray(m),L=Array.isArray(f),M=O===L;return M?O?S.arrayMerge(f,m,S):h(f,m,S):a(m,S)}y.all=function(m,S){if(!Array.isArray(m))throw new Error("first argument should be an array");return m.reduce(function(O,L){return y(O,L,S)},{})};var v=y;return ve=v,ve}var is=ss();const rs=ts(is);class _{static isTouchDevice(t){return t=t||window.navigator.userAgent,"ontouchstart"in window||navigator.maxTouchPoints>0||/ios|iphone|ipad|ipod|android|windows phone/gi.test(t)}static isLandscapeMode(){return window.innerWidth>window.innerHeight}static hasNotch(){return!!navigator.userAgent.match(/iPhone/)}static setTimeoutAsync(t){return new Promise(i=>{setTimeout(()=>{i()},t)})}static mergeDeep(t,...i){return rs.all([t,...i],{arrayMerge:(r,s)=>s})}}class ns{constructor(t,i){this.k=t,this.config={volume:1,fadeOutDuration:1.5,...i}}config;currentMusic;currentMusicName;isFirstPlay=!0;getCurrentMusicName(){return this.currentMusicName}loadMusic(t,i){this.k.loadMusic(t,i)}playMusic(t,i){(async()=>this.currentMusic&&!this.currentMusic.paused&&this.currentMusicName===t||(this.isFirstPlay&&(this.isFirstPlay=!1,await _.setTimeoutAsync(100)),await this.fadeOutCurrentMusic(i?.fadeOutDuration),this.currentMusicName=t,this.currentMusic=this.k.play(t,{loop:!0,volume:this.config.volume,...i})))()}setVolume(t){this.config.volume=t,this.currentMusic&&(this.currentMusic.volume=t)}stopMusic(t){this.fadeOutCurrentMusic(t).then(()=>{this.currentMusic=void 0,this.currentMusicName=void 0})}pauseMusic(){this.currentMusic&&(this.currentMusic.paused=!0)}resumeMusic(){this.currentMusic&&(this.currentMusic.paused=!1)}async fadeOutCurrentMusic(t){t=t??this.config.fadeOutDuration+1e-6,this.currentMusic&&!this.currentMusic.paused&&(await this.k.tween(this.currentMusic.volume,0,t,i=>{this.currentMusic&&(this.currentMusic.volume=i)}),this.currentMusic.stop())}}class as{constructor(t,i="fade",r=.6){this.k=t,this.defaultDuration=r,this.fadeOverlay=t.add(["fade-overlay",t.layer(i),t.rect(t.width(),t.height()),t.color(0,0,0),t.pos(0,0),t.fixed(),t.anchor("topleft"),t.opacity(0),t.stay()])}fadeOverlay;async showOverlay(t=this.defaultDuration){return this.fadeOverlay.opacity=0,this.fadeOverlay.hidden=!1,this.fadeTo(0,1,t)}async hideOverlay(t=this.defaultDuration){await this.fadeTo(1,0,t),this.fadeOverlay.hidden=!1}async fadeTo(t,i,r=1){return new Promise(s=>{let n=0;const o=this.fadeOverlay.onUpdate(()=>{n+=this.k.dt(),this.fadeOverlay.opacity=this.k.lerp(t,i,n/r),n>=r&&(this.fadeOverlay.opacity=i,o.cancel(),s())})})}}class os{_state;localStorageKey="gameState";isUpdating=!1;subscribersOnUpdate=[];subscribersOnDeath=[];get state(){return this._state}constructor(){const t=localStorage.getItem(this.localStorageKey);try{if(t){const i=this.getClearState(),r=JSON.parse(t);this._state=_.mergeDeep(this.getClearState(),{version:i.version,persistent:r,temp:this.getTempStateFromPersistentState(r)})}}catch{}this._state||this.reset()}update(t,i){let r=!1;if(this.isUpdating)throw new Error("Cannot call update() inside another update() call");this.isUpdating=!0,this._state.temp.player.health&&t.temp?.player?.health===0&&(t=_.mergeDeep(t,{persistent:{player:{deaths:this._state.persistent.player.deaths+1}},temp:{player:{tempInventory:[]}}}),r=!0),this._state=_.mergeDeep(this._state,t),this.subscribersOnUpdate.forEach(s=>s(this._state)),t.persistent&&!i&&this.save(),this.isUpdating=!1,r&&this.subscribersOnDeath.forEach(s=>s())}save(){localStorage.setItem(this.localStorageKey,JSON.stringify(this._state.persistent))}reset(){localStorage.removeItem(this.localStorageKey),this._state=this.getClearState(),this.update({})}prepareForNewScene(){this.update({persistent:{player:{inventory:[...this._state.persistent.player.inventory,...this._state.temp.player.tempInventory.filter(t=>!this._state.persistent.player.inventory.includes(t))]}},temp:{...this.getTempStateFromPersistentState(this._state.persistent)}})}getIsPlayerHasItem(t){return this._state.persistent.player.inventory.includes(t)||this._state.temp.player.tempInventory.includes(t)}addToPersistentInventory(t){this.getIsPlayerHasItem(t)||this.update({persistent:{player:{inventory:[...this._state.persistent.player.inventory,t]}}})}addToTempInventory(t){this.getIsPlayerHasItem(t)||this.update({temp:{player:{tempInventory:[...this._state.temp.player.tempInventory,t]}}})}moveTempItemsToPersistentInventory(){const t=this._state.temp.player.tempInventory.filter(i=>!this._state.persistent.player.inventory.includes(i));t.length!==0&&this.update({persistent:{player:{inventory:[...this._state.persistent.player.inventory,...t]}},temp:{player:{tempInventory:[]}}})}onUpdate(t){return this.subscribersOnUpdate.push(t),{cancel:()=>{this.subscribersOnUpdate=this.subscribersOnUpdate.filter(i=>i!==t)}}}onDeath(t){return this.subscribersOnDeath.push(t),{cancel:()=>{this.subscribersOnDeath=this.subscribersOnDeath.filter(i=>i!==t)}}}getTempStateFromPersistentState(t){return{player:{health:t.player.hasLuckyCharm?2:1,tempInventory:[]}}}getClearState(){const t={currentLevel:void 0,player:{deaths:0,hasLuckyCharm:!1,inventory:[]},oldBobr:{isIntroSaid:!1},level1:{isBoarDead:!1}};return{version:1,persistent:t,temp:this.getTempStateFromPersistentState(t)}}}let Ie=!1;async function ye(e,t,i){Ie=i?.quickSwitch||!1,i.isGameLevel&&x.update({persistent:{spawnAtExitIndex:i?.spawnAtExitIndex,currentLevel:t}}),Ie||fe.hide(),await ge.showOverlay(.3),e.go(t)}function Le(e,t){return async()=>{x.prepareForNewScene(),await t(e),await _.setTimeoutAsync(500),Ie?(fe.show(),await ge.hideOverlay(.5)):(await ge.hideOverlay(1),fe.show())}}function Re(e,t,i,r){const s=e.add([e.sprite(t,{tiled:!0,width:e.width()*10}),e.layer("bg"),e.pos(0,0),e.scale(1.5),e.fixed(),e.anchor("center")]);return s.onUpdate(()=>{s.pos.x=e.width()/2+-e.getCamPos().x/50,s.pos.y=e.height()/2+(r?.offsetY||0)-e.getCamPos().y/25}),s}const yt="interactable-comp";function G(e){return{id:yt,interact:e,add(){this.tag("interactable")},destroy(){this.untag("interactable")}}}G.id=yt;const de={async loadResources(e){e.loadSound("player-take-item","sounds/bobr-take-item.mp3")},spawn(e,t,i){const r=e.add(["map-item",e.pos(t),e.sprite(i.sprite,{flipX:i.flipX||!1}),e.anchor("bot"),e.area(),e.scale(),e.animate(),e.offscreen({hide:!0}),...i?.interact?[G(async n=>{await i.interact?.(n),i.shouldPickupOnInteract!==!1&&(e.play("player-take-item"),r.animatePickupAndDestroy(n))})]:[],{animatePickupAndDestroy:s}]);i.levitate&&(r.use(e.animate({relative:!0})),r.animate("pos",[e.vec2(0,-2),e.vec2(0,-6)],{duration:1,easings:[e.easings.easeInOutCubic],direction:"ping-pong"}));function s(n){(async()=>{const o=r.pos;r.unanimate("pos"),await e.tween(0,1,.3,a=>{r.scale=e.vec2(e.lerp(1,.5,a));const l=e.vec2((o.x+n.pos.x)/2,Math.min(o.y,n.pos.y)-30),c=e.lerp(o,l,a),d=e.lerp(l,n.pos,a);r.pos=e.lerp(c,d,a)}),r.destroy()})()}return r}};function he(e,t){if(!x.getIsPlayerHasItem(t.itemId))return de.spawn(e,t.worldPos,{sprite:t.sprite,levitate:!0,interact:async i=>{x.addToTempInventory(t.itemId)},shouldPickupOnInteract:!0})}const ot={async loadResources(e){},spawn(e,t,i){const r=e.add(["exit",e.pos(t),e.rect(32,64,{fill:!1}),e.anchor("bot"),e.area(),e.offscreen({hide:!0})]);return r.onCollide("player",()=>{const s=i.getDestLevelParamsUponUse();s&&ye(e,s.destLevel,{isGameLevel:!0,spawnAtExitIndex:s.destLevelExitIndex,quickSwitch:!0}).then()}),r}};function ls(e,t,i,r){r={speed:.05,...r};const s=_.hasNotch(),n=e.width()/2,o=5;let a="",l=0,c=0,d=!1;const u=e.add([e.rect(n,16,{radius:4}),e.pos(p()),e.color(0,0,0),e.opacity(.6),e.anchor("bot"),e.layer("hud")]),g=u.add([e.pos(e.vec2(0,-o)),e.text("",{size:8,width:n-o*2,font:"pixel",lineSpacing:2}),e.anchor("bot")]);g.onUpdate(()=>{u.height=g.height+o*2,u.pos=p(),d||(c+=e.dt(),c>=r.speed&&(c=0,a+=i[l],g.text=a,l++,l>=i.length&&(d=!0)))});function p(){const h=t.pos.add(0,-t.height),y=e.getCamPos(),v=e.width(),f=e.clamp(h.x,y.x-v/2+n/2+(s?26:0),y.x+v/2-n/2-(s?26:0)),m=h.y;return e.vec2(f,m)}return u}function U(e,t,i,r,s){return new Promise(n=>{let o=0;async function a(){if(o<r.length){const l=ls(e,t,r[o],s);await i.waitForActionButton(),l.destroy(),o++,a().then()}else n()}a().then()})}const R={friction:.2},cs={maxRunSpeed:200,accelGround:200,accelAir:150,decelGround:500,decelAir:300,jumpForce:400,minRunAnimSpeed:1,maxRunAnimSpeed:2,attackPower:1},lt={async loadResources(e){return Promise.all([e.loadSprite("player","sprites/characters/bobr.gif",{sliceX:5,sliceY:4,anims:{idle:{from:0,to:1,speed:3,loop:!0},walk:{from:5,to:8,speed:10,loop:!0},jump:{from:10,to:10},fall:{from:10,to:10},attack:{from:15,to:19,speed:20,loop:!1}}}),e.loadSprite("player-hit-wave","sprites/characters/bobr-hit-wave.png"),e.loadSound("player-attack","sounds/bobr-attack.mp3"),e.loadSound("player-take-item","sounds/bobr-take-item.mp3"),e.loadSound("player-take-key","sounds/bobr-take-key.mp3")])},spawn(e,t=e.vec2(100,100),i){const r={...cs,...i},s=e.add(["player",e.sprite("player",{anim:"idle"}),e.pos(t),e.area({shape:new e.Rect(e.vec2(1,0),20,31),...R}),e.body(),e.anchor("bot"),e.opacity(1),e.state("IDLE",["IDLE","WALK","JUMP","FALL","ATTACK","INTERACT"]),e.timer(),{vx:0,config:r,waitForActionButton:d,setCamFollowPlayer:u,showDialogSeries:g}]);let n,o;function a(){s.jump(r.jumpForce),s.enterState("JUMP")}function l(){return!!o}function c(h,y){s.getCurAnim()?.name!==h&&s.play(h,{onEnd:y})}function d(){return new Promise(h=>{s.onButtonPress("action",()=>{h()})})}function u(h,y){const v=h.levelWidth()-h.tileWidth()/2,f=h.levelHeight()-h.tileHeight()/2,m=e.height(),S=(y.leftTilesPadding??0)*h.tileWidth(),O=(y.rightTilesPadding??0)*h.tileWidth(),L=(y.topTilesPadding??0)*h.tileHeight(),M=(y.bottomTilesPadding??0)*h.tileHeight(),K=h.pos.x+S+e.width()/2,ne=h.pos.x+v-O-e.width()/2,N=h.pos.y+L+e.height()/2,A=h.pos.y+f-M-e.height()/2;s.onUpdate(()=>{if(!s)return;const we=e.clamp(s.pos.x,K,ne),Se=e.clamp(s.pos.y-m/4,N,A);e.setCamPos(we,Se)})}async function g(h,y){s.enterState("INTERACT"),await U(e,s,s,h,y),s.enterState("IDLE")}s.onButtonPress("jump",()=>{s.state!=="INTERACT"&&s.isGrounded()&&a()}),s.onButtonPress("action",()=>{if(s.state==="ATTACK"||s.state==="INTERACT")return;let h=!0,y=!1;const v=s.add(["player.interaction-hitbox",e.pos(s.flipX?-14:14,0),e.area({shape:new e.Rect(e.vec2(1,0),16,s.height)}),e.rect(20,20,{fill:!1}),e.anchor("bot"),e.opacity(0)]);v.onCollide("interactable",async f=>{y||f.hidden||(y=!0,s.enterState("INTERACT"),await f.interact(s),s.enterState("IDLE"))}),v.onUpdate(()=>{h?h=!1:(y||s.enterState("ATTACK"),s.remove(v))})}),s.onFixedUpdate(()=>{const h=e.dt(),y=s.isGrounded();let v=0;if(s.state!=="INTERACT"&&(e.isButtonDown("left")?v=-1:e.isButtonDown("right")&&(v=1)),s.friction=y?R.friction:0,v!==0){let f=y?r.accelGround:r.accelAir;Math.sign(v)!==Math.sign(s.vx)&&(f+=y?r.decelGround:r.decelAir),s.vx=us(s.vx,v*r.maxRunSpeed,f*h)}else{const f=y?r.decelGround:r.decelAir,m=Math.max(0,Math.abs(s.vx)-f*h);s.vx=m*Math.sign(s.vx)}s.move(s.vx,0),s.flipX=v<0?!0:v>0?!1:s.flipX,s.area.scale.x=s.flipX?-1:1,s.state==="ATTACK"?s.getCurAnim()?.frameIndex===2&&(n||(n=s.add(["player.hitbox",e.pos(e.vec2(s.flipX?-16:16,0)),e.area(),e.sprite("player-hit-wave",{flipX:s.flipX}),e.anchor("bot"),e.opacity(1),e.lifespan(0,{fade:.15})]),n.onCollide("enemy",f=>{f.registerHit(s),e.play("player-attack")}),n.onDestroy(()=>{n=void 0}))):s.state==="INTERACT"||(y?Math.abs(s.vx)>5?s.enterState("WALK"):s.enterState("IDLE"):s.vel.y<0?s.enterState("JUMP"):s.enterState("FALL")),l()?s.opacity=Math.abs(Math.sin(e.time()*20))*.5+.5:s.opacity=1}),s.onStateEnter("IDLE",()=>{c("idle")}),s.onStateEnter("INTERACT",()=>{c("idle")}),s.onStateUpdate("WALK",()=>{c("walk");const h=e.clamp(Math.abs(s.vx)/r.maxRunSpeed,0,1);s.animSpeed=e.lerp(r.minRunAnimSpeed,r.maxRunAnimSpeed,h)}),s.onStateEnter("JUMP",()=>{c("jump")}),s.onStateEnter("FALL",()=>{c("fall")}),s.onStateEnter("ATTACK",()=>{c("attack",()=>{s.enterState("IDLE")}),s.animSpeed=1}),s.onCollideUpdate("enemy",h=>{!l()&&s.state!=="ATTACK"&&!h.dead&&h.config.attackPower&&(x.update({temp:{player:{health:Math.max(0,x.state.temp.player.health-h.config.attackPower)}}}),s.applyImpulse(e.vec2(Math.sign(s.pos.x-h.pos.x)*(h.config.knockbackPower?.x??150),s.vel.y>-50?h.config.knockbackPower?.y??-230:0)),e.shake(4),e.play("player-attack"),o?.cancel(),o=s.wait(1),o.onEnd(()=>{o=void 0}))});const p=x.onDeath(()=>{ye(e,x.state.persistent.currentLevel,{isGameLevel:!0,spawnAtExitIndex:x.state.persistent.spawnAtExitIndex,quickSwitch:!1}).then()});return s.onDestroy(()=>{o?.cancel(),o=void 0,p.cancel()}),s}};function be(e){const t=e.get("player");return t.length>0?t[0]:void 0}function us(e,t,i){const r=t-e;return Math.abs(r)<=i?t:e+Math.sign(t)*i}async function Ee(e,t,i){const r=[];let s,n=t.split(`
`);await lt.loadResources(e),await ot.loadResources(e),await i.preloadResources(e),await Promise.all(Object.values(i.tiles).map(d=>d.loadResources(e))),e.setGravity(0);const o=e.addLevel(n,{pos:e.vec2(0,0),tileWidth:i.tileWidth,tileHeight:i.tileHeight,tiles:{},wildcardTile:(d,u)=>{if(d.trim()){if(d==="P"){s=u.scale(e.vec2(i.tileWidth,i.tileHeight));return}if(d==="E"){r.push({worldPos:u.scale(e.vec2(i.tileWidth,i.tileHeight))});return}if(i.tiles[d])return i.tiles[d].factory(e,u,u.scale(e.vec2(i.tileWidth,i.tileHeight)),()=>c(u.x,u.y),l)||void 0}}});if(r.sort((d,u)=>d.worldPos.x===u.worldPos.x?d.worldPos.y-u.worldPos.y:d.worldPos.x-u.worldPos.x),r.forEach((d,u)=>{ot.spawn(e,d.worldPos,i.exitPoints[u])}),x.state.persistent.spawnAtExitIndex!==void 0){const d=x.state.persistent.spawnAtExitIndex;if(!r[d]){e.debug.error("Invalid exit index to spawn at:"+d);return}s=r[d].worldPos.add(i.exitPoints[d].spawnOffsetTiles.scale(e.vec2(i.tileWidth,i.tileHeight)))}else x.update({persistent:{spawnAtExitIndex:void 0}});if(!s){e.debug.error("No player spawn point found on the map!");return}const a=lt.spawn(e,s);e.setGravity(1e3);function l(d,u){return u<0||u>=n.length||d<0||d>=n[u].length?" ":n[u][d]}function c(d,u){return{top:l(d,u-1),bottom:l(d,u+1),left:l(d-1,u),right:l(d+1,u),topLeft:l(d-1,u-1),topRight:l(d+1,u-1),bottomLeft:l(d-1,u+1),bottomRight:l(d+1,u+1)}}return{level:o,player:a}}const Y={async loadResources(e){return Promise.all([e.loadSprite("bumblebee","sprites/enemies/bumblebee.gif",{sliceX:2,sliceY:1,anims:{idle:{from:0,to:1,speed:20,loop:!0},fly:{from:0,to:1,speed:20,loop:!0}}})])},spawn(e,t=e.vec2(200,80),i){const r={health:1,attackPower:1,speedX:70,flyDuration:3,...i};let s=-1,n=0,o=!0;const a=e.add(["bumblebee","enemy",e.sprite("bumblebee",{anim:"idle"}),e.state("FLY",["IDLE","FLY"]),e.health(r.health,r.health),e.timer(),e.pos(t),e.area({...R,collisionIgnore:["obstacle"]}),e.body({gravityScale:0}),e.anchor("center"),e.offscreen({pause:!0,unpause:!0,hide:!0}),{registerHit:c=>{a.applyImpulse(e.vec2(Math.sign(a.pos.x-c.pos.x)*180,-120)),a.hp-=c.config.attackPower},config:r}]);function l(c,d){return Math.sin(d*c)*-30}return a.onStateEnter("FLY",async()=>{a.flipX=s<0,a.play("fly"),await a.wait(r.flyDuration*(o?.5:1)),o=!1,a.enterState("IDLE")}),a.onStateUpdate("FLY",()=>{n+=e.dt(),a.move(r.speedX*s,l(6,n))}),a.onStateEnter("IDLE",async()=>{a.play("idle"),await a.wait(1.5),a.dead||(s*=-1,a.enterState("FLY"))}),a.onStateUpdate("IDLE",()=>{n+=e.dt(),a.move(0,l(12,n))}),a.onDeath(()=>{a.paused=!0,a.gravityScale=1,a.collisionIgnore=["*"],a.use(e.rotate(a.flipX?15:-15))}),a.onExitScreen(()=>{a.dead&&a.destroy()}),a}};var T=(e=>(e.HOME_KITCHEN_CHAIR_LEFT="home-kitchen-chair-left",e.HOME_KITCHEN_CHAIR_RIGHT="home-kitchen-chair-right",e.HOME_KITCHEN_TABLE="home-kitchen-table",e.HOME_BED="home-bed",e))(T||{});const J={async loadResources(e){return Promise.all([e.loadSprite("gopher","sprites/enemies/gopher.gif",{sliceX:4,sliceY:1,anims:{idle:{from:0,to:0,loop:!1},walk:{from:0,to:3,speed:10,loop:!0}}})])},spawn(e,t=e.vec2(100,100),i){const r={health:2,attackPower:1,speedX:50,...i};let s=-1,n=!0;const o=e.add(["gopher","enemy",e.sprite("gopher",{anim:"idle"}),e.state("WALK",["IDLE","WALK"]),e.health(r.health,r.health),e.timer(),e.pos(t),e.area(R),e.body(),e.anchor("bot"),e.offscreen({pause:!0,unpause:!0,hide:!0}),{registerHit:a=>{o.applyImpulse(e.vec2(Math.sign(o.pos.x-a.pos.x)*100,-200)),o.hp-=a.config.attackPower},config:r}]);return o.onStateEnter("WALK",async()=>{o.flipX=s<0,o.play("walk"),await o.wait(4*(n?.5:1)),n=!1,o.enterState("IDLE")}),o.onStateUpdate("WALK",()=>{o.isGrounded()&&o.move(r.speedX*s,0)}),o.onStateEnter("IDLE",async()=>{o.play("idle"),await o.wait(2),o.dead||(s*=-1,o.enterState("WALK"))}),o.onDeath(()=>{o.paused=!0,o.collisionIgnore=["*"],o.use(e.rotate(o.flipX?10:-10))}),o.onExitScreen(()=>{o.dead&&o.destroy()}),o}},ct={async loadResources(e){return E.loadMusic("home","music/home.mp3"),Promise.all([e.loadSprite("home-outside","sprites/home/home-outside.png"),e.loadSprite("home-inside","sprites/home/home-inside.png"),e.loadSprite("home-fence","sprites/home/home-fence.png"),e.loadSprite("home-kitchen-table","sprites/home/home-kitchen-table.png"),e.loadSprite("home-kitchen-chair-left","sprites/home/home-kitchen-chair-left.png"),e.loadSprite("home-kitchen-chair-right","sprites/home/home-kitchen-chair-right.png"),e.loadSprite("home-bed","sprites/home/home-bed.png")])},spawn(e,t,i){({...i});let r=!0;const s=e.add(["home-container",e.pos(t),e.anchor("botleft"),e.offscreen({hide:!0,pause:!0,unpause:!0,distance:300}),e.state("OUTSIDE",["INSIDE","OUTSIDE"])]);s.add([e.sprite("home-fence"),e.pos(206,0),e.anchor("botleft")]),s.add(["home-outside",e.sprite("home-inside"),e.anchor("botleft")]);const n=s.add(["home-kitchen-chair-left",e.sprite("home-kitchen-chair-left"),e.anchor("bot"),e.pos(64,0),e.area(),G(async p=>{await U(e,p,p,[I(e.choose(["home.kitchenChairRepeat1"]))])})]);n.hidden=!0;const o=s.add(["home-kitchen-table",e.sprite("home-kitchen-table"),e.anchor("bot"),e.pos(92,0),e.area(),e.z(1),G(async p=>{await U(e,p,p,[I(e.choose(["home.kitchenTableRepeat1","home.kitchenTableRepeat2","home.kitchenTableRepeat3"]))])})]);o.hidden=!0;const a=s.add(["home-kitchen-chair-right",e.sprite("home-kitchen-chair-right"),e.anchor("bot"),e.pos(120,0),e.area(),G(async p=>{await U(e,p,p,[I(e.choose(["home.kitchenChairRepeat1"]))])})]);a.hidden=!0;const l=s.add(["home-bed",e.sprite("home-bed",{flipX:!0}),e.anchor("bot"),e.pos(129,-65),e.area(),G(async p=>{await U(e,p,p,[I(e.choose(["home.bedRepeat1"]))])})]);l.hidden=!0;const c=s.add(["home-outside",e.sprite("home-outside"),e.anchor("botleft"),e.animate({relative:!0}),e.z(2)]);ds(e,s);function d(){const p=x.getIsPlayerHasItem(T.HOME_KITCHEN_TABLE),h=x.getIsPlayerHasItem(T.HOME_KITCHEN_CHAIR_LEFT),y=x.getIsPlayerHasItem(T.HOME_KITCHEN_CHAIR_RIGHT),v=x.getIsPlayerHasItem(T.HOME_BED);o.hidden=!p,n.hidden=!h,a.hidden=!y,l.hidden=!v}return s.onStateEnter("OUTSIDE",()=>{if(r){r=!1;return}c.unanimateAll(),c.animation.seek(0),c.animate("opacity",[0,1],{duration:1,loops:1}),E.playMusic("start-location")}),s.onStateEnter("INSIDE",()=>{x.moveTempItemsToPersistentInventory(),d(),c.unanimateAll(),c.animation.seek(0),c.animate("opacity",[1,0],{duration:1,loops:1}),x.state.persistent.player.inventory.length>0&&E.playMusic("home")}),s.add(["home-entrance",e.rect(20,38,{fill:!1}),e.pos(125,0),e.anchor("botleft"),e.area()]).onCollide("player",()=>{s.state!=="INSIDE"&&s.enterState("INSIDE")}),s.add(["home-exit",e.rect(20,38,{fill:!1}),e.pos(214,0),e.anchor("botleft"),e.area()]).onCollide("player",()=>{s.state!=="OUTSIDE"&&s.enterState("OUTSIDE")}),d(),s}};function ds(e,t){t.add(["obstacle",e.rect(14,200,{fill:!1}),e.pos(193,-42),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.rect(40,12,{fill:!1}),e.pos(156,-42),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.rect(10,220,{fill:!1}),e.pos(-10,0),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.polygon([e.vec2(178,-54),e.vec2(115,-193),e.vec2(125,-193),e.vec2(188,-54)],{fill:!1}),e.pos(-5,0),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.polygon([e.vec2(115,-193),e.vec2(50,-221),e.vec2(50,-230),e.vec2(125,-193)],{fill:!1}),e.pos(-5,0),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.polygon([e.vec2(50,-221),e.vec2(0,-221),e.vec2(0,-230),e.vec2(50,-230)],{fill:!1}),e.pos(-5,0),e.anchor("botleft"),e.area(),e.body({isStatic:!0})]),t.add(["obstacle",e.rect(120,7,{fill:!1}),e.pos(57,-58),e.anchor("botleft"),e.area(R),e.body({isStatic:!0})]),t.add(["obstacle",e.rect(95,7,{fill:!1}),e.pos(0,-122),e.anchor("botleft"),e.area(R),e.body({isStatic:!0})])}const ut=hs(),w=St({global:!1,width:ut.width,height:ut.height,background:"#000000",letterbox:!0,pixelDensity:2,debug:!0,debugKey:"`",buttons:{left:{keyboard:["left","a"],gamepad:["dpad-left"]},right:{keyboard:["right","d"],gamepad:["dpad-right"]},jump:{keyboard:["space","up","w","k"],gamepad:["south"]},action:{keyboard:["j","z"],gamepad:["east"]}}});function hs(){let e=Math.min(window.innerWidth,400);e%2!==0&&(e-=1);let t=Math.floor(e/(window.innerWidth/window.innerHeight));return t%2!==0&&(t-=1),{width:e,height:t}}const bt="info-icon-comp";function Pe(e=0){let t;return{id:bt,add(){w.loadSprite("info-icon","sprites/icons/info.png"),t=this.add([w.sprite("info-icon"),w.pos(e,-this.height-2),w.anchor("bot"),w.animate({relative:!0})]),t.animate("pos",[w.vec2(0,0),w.vec2(0,-2),w.vec2(0,0),w.vec2(0,-2),w.vec2(0,0),w.vec2(0,0),w.vec2(0,0)],{duration:1,direction:"forward"})},destroy(){t?.destroy(),t=void 0}}}Pe.id=bt;const dt={async loadResources(e){return Promise.all([e.loadSprite("boar","sprites/enemies/boar.gif",{sliceX:2,sliceY:4,anims:{idle:{from:0,to:0},alarm:{from:2,to:2},run:{from:4,to:5,speed:12,loop:!0},break:{from:6,to:6}}}),e.loadSprite("particle-ground","sprites/particles/ground.png",{sliceX:2,sliceY:1}),e.loadSound("boar-alarm","sounds/boar-squeal.mp3"),e.loadSound("boar-break","sounds/boar-break.mp3")])},spawn(e,t=e.vec2(100,100),i){const r={health:i?.isAlreadyDead?0:5,attackPower:1,knockbackPower:e.vec2(250,-230),detectionRange:150,alarmDuration:.8,breakDuration:1.3,maxSpeed:220,acceleration:400,deceleration:300,isAlreadyDead:!1,...i};let s=-1,n=0,o=null;const a=e.add(["boar","enemy",e.sprite("boar",{anim:"idle"}),e.state("IDLE",["IDLE","ALARM","RUN","BREAK","DEAD"]),e.health(r.health,r.health),e.timer(),e.pos(t),e.area({...R,shape:new e.Rect(e.vec2(0,0),50,40)}),e.body({mass:2}),e.anchor("bot"),e.offscreen(),{registerHit:u=>{a.applyImpulse(e.vec2(Math.sign(a.pos.x-u.pos.x)*150,0)),a.hp-=u.config.attackPower},config:r}]),l=a.add([e.particles({max:20,speed:[100,60],lifeTime:[.75,1],angle:[0,360],angularVelocity:[0,30],opacities:[1,1,0],texture:e.getSprite("particle-ground").data.tex,quads:e.getSprite("particle-ground").data.frames},{position:e.vec2(0,0),direction:-15,spread:15})]);function c(){return o||(o=be(e),o)}function d(){const u=c();return u&&a.pos.dist(u.pos)<=r.detectionRange?u:null}return a.onStateEnter("IDLE",async()=>{a.play("idle"),a.flipX=s<0}),a.onStateUpdate("IDLE",()=>{if(a.dead)return;const u=d();u&&(s=u.pos.x>a.pos.x?1:-1,a.enterState("ALARM"))}),a.onStateEnter("ALARM",async()=>{a.flipX=s<0,a.play("alarm"),e.play("boar-alarm"),a.applyImpulse(e.vec2(0,-150)),await a.wait(r.alarmDuration),a.dead||a.enterState("RUN")}),a.onStateEnter("RUN",()=>{a.play("run"),l.emitter.direction=s<0?-15:195}),a.onStateEnter("BREAK",async()=>{a.play("break"),e.play("boar-break"),await a.wait(r.breakDuration),a.dead||a.enterState("IDLE")}),a.onStateUpdate("DEAD",()=>{a.untag("enemy"),a.play("break")}),a.onFixedUpdate(()=>{if(a.state==="RUN"){const u=o.pos.x-a.pos.x;if(s>0&&u<5||s<0&&u>-5){a.enterState("BREAK");return}n<r.maxSpeed?(n=e.clamp(n+r.acceleration*e.dt(),0,r.maxSpeed),a.move(s*n,0)):a.move(s*r.maxSpeed,0),n>r.maxSpeed/5&&Math.round(e.time()*10)%4===0&&l.emit(1)}else(a.state==="BREAK"||a.state==="DEAD")&&n>0&&(n=e.clamp(n-r.deceleration*e.dt(),0,r.maxSpeed),a.move(s*n,0),n>r.maxSpeed/10&&l.emit(1))}),a.onCollide("player",()=>{a.dead||a.enterState("BREAK")}),a.onDeath(()=>{a.enterState("DEAD"),i.onDeath?.()}),i.isAlreadyDead&&a.enterState("DEAD"),a}},ps=`.                                           ..
.                                            .
.                                            .
.                  ,t,,                      .
.                 ------   , t,,             .
.                          -----             .
.E,<,B, ,                       ,, ,         .
.=========\\\\ , ,,               ----         .
............===--                  , 1, ,t,, .
...............                    ---=======.
...............                       ........
...............\\\\ ,,, , ,,  ,,,H, , //........
.................===================..........
..............................................
..............................................`,Ce={async loadResources(e){return Promise.all([e.loadSprite("direction-sign","sprites/tiles/direction-sign.png")])},factory(e,t,i,r,s){return[e.sprite("direction-sign",{flipX:!0}),e.anchor("bot")]}},Te={async loadResources(e){return Promise.all([e.loadSprite("direction-sign","sprites/tiles/direction-sign.png")])},factory(e,t,i,r,s){return[e.sprite("direction-sign"),e.anchor("bot")]}},Ae={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-1","sprites/tiles/grass-1.png"),e.loadSprite("tile-grass-2","sprites/tiles/grass-2.png"),e.loadSprite("tile-grass-3","sprites/tiles/grass-3.png")])},factory(e,t,i,r,s){return[e.sprite(e.choose(["tile-grass-1","tile-grass-2","tile-grass-3"]),{flipX:e.choose([!0,!1])}),e.z(e.choose([1,-1])),e.anchor("bot"),e.offscreen({hide:!0})]}},De={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-ground-inclined-left-1","sprites/tiles/grass-ground-inclined-left-1.png"),e.loadSprite("tile-ground","sprites/tiles/ground.png")])},factory(e,t,i,r,s){const n=r();if(n.topRight==="/")return["obstacle",e.sprite("tile-grass-ground-inclined-left-1"),e.anchor("bot"),e.offscreen({hide:!0})];if(n.topLeft==="\\")return["obstacle",e.sprite("tile-grass-ground-inclined-left-1",{flipX:!0}),e.anchor("bot"),e.offscreen({hide:!0})];const o=n.left===" "||n.right===" "||n.bottom===" "||n.left==="";return["obstacle",e.sprite("tile-ground"),...o?[e.area(R),e.body({isStatic:!0})]:[],e.anchor("bot"),e.offscreen({hide:!0})]}},Me={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-ground","sprites/tiles/grass-ground.png")])},factory(e,t,i,r,s){return[e.sprite("tile-grass-ground"),e.area(R),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]}},Ne={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-ground-air","sprites/tiles/grass-ground-air.png"),e.loadSprite("tile-grass-ground-air-left","sprites/tiles/grass-ground-air-left.png"),e.loadSprite("tile-grass-ground-air-right","sprites/tiles/grass-ground-air-right.png")])},factory(e,t,i,r,s){const n=r();return["obstacle",e.sprite(n.left===" "?"tile-grass-ground-air-left":n.right===" "?"tile-grass-ground-air-right":"tile-grass-ground-air"),e.area({...R,shape:new e.Rect(e.vec2(0,-8),32,24)}),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]}},Fe={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-ground-inclined-left-2","sprites/tiles/grass-ground-inclined-left-2.png"),e.loadSprite("tile-grass-ground-inclined-left-3","sprites/tiles/grass-ground-inclined-left-3.png")])},factory(e,t,i,r,s){return r().left==="/"?["obstacle",e.sprite("tile-grass-ground-inclined-left-3"),e.area({...R,shape:new e.Polygon([e.vec2(-16,0),e.vec2(-16,-16),e.vec2(16,-32),e.vec2(16,0)])}),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]:["obstacle",e.sprite("tile-grass-ground-inclined-left-2"),e.area({...R,shape:new e.Polygon([e.vec2(-16,0),e.vec2(16,-16),e.vec2(16,0),e.vec2(-16,16)])}),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]}},$e={async loadResources(e){return Promise.all([e.loadSprite("tile-grass-ground-inclined-left-2","sprites/tiles/grass-ground-inclined-left-2.png"),e.loadSprite("tile-grass-ground-inclined-left-3","sprites/tiles/grass-ground-inclined-left-3.png")])},factory(e,t,i,r,s){return r().right==="\\"?["obstacle",e.sprite("tile-grass-ground-inclined-left-3",{flipX:!0}),e.area({...R,shape:new e.Polygon([e.vec2(16,0),e.vec2(16,-16),e.vec2(-16,-32),e.vec2(-16,0)])}),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]:["obstacle",e.sprite("tile-grass-ground-inclined-left-2",{flipX:!0}),e.area({...R,shape:new e.Polygon([e.vec2(16,0),e.vec2(-16,-16),e.vec2(-16,0),e.vec2(16,16)])}),e.body({isStatic:!0}),e.anchor("bot"),e.offscreen({hide:!0})]}},je={async loadResources(e){return Promise.all([e.loadSprite("rock","sprites/tiles/rock.png")])},factory(e,t,i,r,s){return["obstacle",e.sprite("rock",{flipX:e.choose([!0,!1])}),e.anchor("bot"),e.area(R),e.body({mass:2}),e.offscreen({hide:!0})]}},He={async loadResources(e){return Promise.all([e.loadSprite("tile-tree-1","sprites/tiles/tree-1.png"),e.loadSprite("tile-tree-2","sprites/tiles/tree-2.png")])},factory(e,t,i,r,s){return[e.sprite(e.choose(["tile-tree-1","tile-tree-2"]),{flipX:e.choose([!0,!1])}),e.z(e.choose([1,-1])),e.anchor("bot"),e.offscreen({hide:!0})]}},pe=async e=>{const{player:t,level:i}=await Ee(e,ps,{preloadResources:async s=>{E.loadMusic("start-location","music/start-location.mp3"),E.loadMusic("boar-boss-fight","music/boar-boss-fight.mp3")},tileWidth:32,tileHeight:32,tiles:{">":Te,"<":Ce,"=":Me,"-":Ne,".":De,",":Ae,"/":Fe,"\\":$e,t:He,r:je,G:{loadResources:J.loadResources,factory:(s,n,o)=>{J.spawn(s,o)}},F:{loadResources:Y.loadResources,factory:(s,n,o)=>{Y.spawn(s,o)}},B:{loadResources:Q.loadResources,factory:(s,n,o)=>{Q.spawn(s,o,{flipX:!0})}},H:{loadResources:dt.loadResources,factory:(s,n,o)=>{dt.spawn(s,o,{isAlreadyDead:x.state.persistent.level1.isBoarDead,onDeath:()=>{r()}})}},1:{loadResources:async s=>{await s.loadSprite("home-bed","sprites/home/home-bed.png")},factory:(s,n,o)=>{he(s,{itemId:T.HOME_BED,sprite:"home-bed",worldPos:o})}}},exitPoints:[{currentMapExitIndex:0,spawnOffsetTiles:e.vec2(2,0),getDestLevelParamsUponUse:()=>{if(x.state.persistent.level1.isBoarDead&&[T.HOME_BED].some(n=>!x.getIsPlayerHasItem(n))){be(e).showDialogSeries([I("common.notAllItemsFound")]).then();return}return{destLevel:q.id,destLevelExitIndex:1}}}]});await e.loadSprite("bg-home-day","sprites/backgrounds/home-day.png"),Re(e,"bg-home-day",t,{offsetY:40}),t.setCamFollowPlayer(i,{leftTilesPadding:2,rightTilesPadding:2,topTilesPadding:-5}),x.state.persistent.level1.isBoarDead?E.playMusic("start-location"):(E.getCurrentMusicName()!=="boar-boss-fight"&&E.stopMusic(),e.get("boar")[0].onEnterScreen(()=>{x.state.persistent.level1.isBoarDead||E.playMusic("boar-boss-fight")}));function r(){x.update({persistent:{level1:{isBoarDead:!0}}}),E.playMusic("start-location")}};pe.id="level-1-3";const fs=`                                                                                         .
                                                                                         .
                                                                    ,,                   .
                                                              t,,  --- ,   , ,, ,tG,, >,E.
.                           ,tG,,   ,1,F                     ----  ,2F --  ----===========
.           ,t ,r  F       -------  ---             F,,t ,,        ----        ...........
.           -----                                  --====--                    ...........
.                ,,,                ,G,              ....                      ...........
.E,<,B, ,  , ,,//===\\\\G,t,,  ,F ,,//===\\\\,t ,,tG ,,//....\\\\ ,,,r,,t, ,, ,t ,G//...........
.==============.......============.......==========........==================.............
..........................................................................................
..........................................................................................`,q=async e=>{const{player:t,level:i}=await Ee(e,fs,{preloadResources:async r=>{E.loadMusic("start-location","music/start-location.mp3")},tileWidth:32,tileHeight:32,tiles:{">":Te,"<":Ce,"=":Me,"-":Ne,".":De,",":Ae,"/":Fe,"\\":$e,t:He,r:je,G:{loadResources:J.loadResources,factory:(r,s,n)=>{J.spawn(r,n)}},F:{loadResources:Y.loadResources,factory:(r,s,n)=>{Y.spawn(r,n)}},B:{loadResources:Q.loadResources,factory:(r,s,n)=>{Q.spawn(r,n,{flipX:!0})}},1:{loadResources:async r=>{await de.loadResources(r),await r.loadSprite("home-kitchen-chair-right","sprites/home/home-kitchen-chair-right.png")},factory:(r,s,n)=>{he(r,{itemId:T.HOME_KITCHEN_CHAIR_RIGHT,sprite:"home-kitchen-chair-right",worldPos:n})}}},exitPoints:[{currentMapExitIndex:0,spawnOffsetTiles:e.vec2(2,0),getDestLevelParamsUponUse:()=>({destLevel:Z.id,destLevelExitIndex:0})},{currentMapExitIndex:1,spawnOffsetTiles:e.vec2(-2,0),getDestLevelParamsUponUse:()=>{if([T.HOME_KITCHEN_CHAIR_RIGHT].some(s=>!x.getIsPlayerHasItem(s))){be(e).showDialogSeries([I("common.notAllItemsFound")]).then();return}return{destLevel:pe.id,destLevelExitIndex:0}}}]});await e.loadSprite("bg-home-day","sprites/backgrounds/home-day.png"),Re(e,"bg-home-day",t,{offsetY:40}),E.playMusic("start-location"),t.setCamFollowPlayer(i,{leftTilesPadding:2,rightTilesPadding:2,topTilesPadding:-5})};q.id="level-1-2";const Q={async loadResources(e){return Promise.all([e.loadSprite("old-bobr","sprites/characters/old-bobr.gif",{sliceX:2,sliceY:1,anims:{idle:{from:0,to:1,speed:1.5,loop:!0}}}),e.loadSound("old-bobr-kurwa-1","sounds/old-bobr-kurwa-1.mp3"),e.loadSound("old-bobr-kurwa-2","sounds/old-bobr-kurwa-2.mp3")])},spawn(e,t=e.vec2(100,100),i){const r={...i},s=e.add(["old-bobr",e.sprite("old-bobr",{anim:"idle",flipX:r.flipX||!1}),e.state("IDLE",["IDLE","INTERACTING"]),e.timer(),e.pos(t),e.area({...R,collisionIgnore:["player","enemy"]}),e.body(),e.anchor("bot"),e.offscreen({pause:!0,unpause:!0,hide:!0}),G(n),{config:r,shouldShowInfoIcon:o}]);async function n(d){const u=l();u&&(s.enterState("INTERACTING"),e.play(e.choose(["old-bobr-kurwa-1","old-bobr-kurwa-2"])),s.flipX=s.pos.x>d.pos.x,await c(u,d),s.enterState("IDLE"))}function o(){if(s.state==="INTERACTING")return!1;const d=l();if(!d)return!1;switch(d){case"SAY_INTRO_REPEAT":return!1;default:return!0}}function a(){o()?s.use(Pe(6*(s.flipX?-1:1))):s.unuse(Pe.id)}function l(){const d=x.state;return d.persistent.oldBobr.isIntroSaid?d.persistent.player.deaths>=1&&!d.persistent.player.hasLuckyCharm?"GIVE_LUCKY_CHARM":d.persistent.currentLevel===q.id&&!d.persistent.oldBobr.isRespawnInfoSaid?"SAY_RESPAWN_INFO":"SAY_INTRO_REPEAT":"SAY_INTRO"}async function c(d,u){switch(x.state,d){case"SAY_INTRO":await U(e,s,u,[I("oldBobr.intro1"),I("oldBobr.intro2")]),x.update({persistent:{oldBobr:{isIntroSaid:!0}}});break;case"SAY_INTRO_REPEAT":await U(e,s,u,[I(e.choose(["oldBobr.introRepeat1","oldBobr.introRepeat2","oldBobr.introRepeat3"]))]);break;case"GIVE_LUCKY_CHARM":await U(e,s,u,[I("oldBobr.giveLuckyCharm1"),I("oldBobr.giveLuckyCharm2"),I("oldBobr.giveLuckyCharm3")]),x.update({persistent:{player:{hasLuckyCharm:!0}},temp:{player:{health:2}}});break;case"SAY_RESPAWN_INFO":await U(e,s,u,[I("oldBobr.respawnInfo1"),I("oldBobr.respawnInfo2")]),x.update({persistent:{oldBobr:{isRespawnInfoSaid:!0}}});break}}return s.onStateEnter("IDLE",async()=>{s.play("idle"),a()}),s.onStateEnter("INTERACTING",async()=>{a()}),s.onEnterScreen(()=>{a()}),s}},gs=`                                                                                        .
                                                                                        .
                                                                                        .
                                                           ,2,               ,, ,tG,,>,E.
                         F 1,,                             ---             ---==========.
                           ---                                  , ,Gt,,,      ...........
                              ,t,F             ,tF,,,r         ---------      ...........
          P     ,,,           -----        F ---------          F             ...........
H      ,B,  ,,//===\\\\,,t,,,   , G , ,,  t   ,  ,,, ,G, ,,, ,, , ,, ,  ,G,,t //...........
==============.......=======================================================.............
.........................................................................................
.........................................................................................`,Z=async e=>{const{player:t,level:i}=await Ee(e,gs,{preloadResources:async r=>{E.loadMusic("home","music/home.mp3"),E.loadMusic("start-location","music/start-location.mp3")},tileWidth:32,tileHeight:32,tiles:{">":Te,"<":Ce,"=":Me,"-":Ne,".":De,",":Ae,"/":Fe,"\\":$e,t:He,r:je,G:{loadResources:J.loadResources,factory:(r,s,n)=>{J.spawn(r,n)}},F:{loadResources:Y.loadResources,factory:(r,s,n)=>{Y.spawn(r,n)}},H:{loadResources:ct.loadResources,factory:(r,s,n)=>{ct.spawn(r,n)}},B:{loadResources:Q.loadResources,factory:(r,s,n)=>{Q.spawn(r,n)}},1:{loadResources:de.loadResources,factory:(r,s,n)=>{he(r,{itemId:T.HOME_KITCHEN_CHAIR_LEFT,sprite:"home-kitchen-chair-left",worldPos:n})}},2:{loadResources:de.loadResources,factory:(r,s,n)=>{he(r,{itemId:T.HOME_KITCHEN_TABLE,sprite:"home-kitchen-table",worldPos:n})}}},exitPoints:[{currentMapExitIndex:0,spawnOffsetTiles:e.vec2(-2,0),getDestLevelParamsUponUse:()=>{if([T.HOME_KITCHEN_CHAIR_LEFT,T.HOME_KITCHEN_TABLE].some(s=>!x.getIsPlayerHasItem(s))){be(e).showDialogSeries([I("common.notAllItemsFound")]).then();return}return{destLevel:q.id,destLevelExitIndex:0}}}]});await e.loadSprite("bg-home-day","sprites/backgrounds/home-day.png"),Re(e,"bg-home-day",t,{offsetY:40}),E.playMusic("start-location"),t.setCamFollowPlayer(i,{rightTilesPadding:2,topTilesPadding:-5})};Z.id="level-1-1";const wt="hud-comp";function B(e){return{id:wt,shouldBeShown:e.shouldBeShown,targetOpacity:e.targetOpacity||1,add(){this.tag("hud"),this.use(w.layer("hud")),this.use(w.fixed()),this.use(w.stay()),this.use(w.opacity(e.targetOpacity))}}}B.id=wt;function ms(e,t){const i=t?.size??100,r=t?.deadZone??.1;e.loadSprite("joystick.jump","sprites/icons/jump.gif"),e.loadSprite("joystick.attack","sprites/icons/attack.gif");let s=!1,n=e.vec2(0,0),o=e.vec2(0,0);const a=e.add(["joystickBase",B({shouldBeShown:!0,targetOpacity:.2}),e.pos(-9999,-9999),e.circle(i/2),e.color(0,0,0),e.anchor("center"),{releaseKnob:u}]),l=e.add(["joystickKnob",B({shouldBeShown:!0,targetOpacity:.7}),e.pos(-9999,-9999),e.circle(i/4),e.color(255,255,255),e.anchor("center")]),c=e.add(["jumpButton",B({shouldBeShown:!0,targetOpacity:.2}),e.pos(e.width()-i*.5,e.height()-i*.5),e.area(),e.circle(i/3),e.color(0,0,0),e.anchor("center")]);e.add([B({shouldBeShown:!0}),e.sprite("joystick.jump"),e.pos(c.pos),e.anchor("center")]),c.onClick(()=>{e.pressButton("jump"),e.releaseButton("jump")});const d=e.add(["attackButton",B({shouldBeShown:!0,targetOpacity:.2}),e.pos(e.width()-i*1.1,e.height()-i*1.1),e.area(),e.circle(i/2.5),e.color(0,0,0),e.anchor("center")]);e.add([B({shouldBeShown:!0}),e.sprite("joystick.attack"),e.pos(d.pos),e.anchor("center"),e.scale(1.2)]),d.onClick(()=>{e.pressButton("action"),e.releaseButton("action")}),a.onTouchStart(g=>{g.x>e.width()*.6||(n=g,s=!0,a.pos=n,l.pos=n,a.hidden=!1,l.hidden=!1)}),a.onTouchMove(g=>{if(!s||g.x>e.width()*.6)return;o=g.sub(n);const p=i/2,h=e.vec2(e.clamp(o.x,-p,p),e.clamp(o.y,-p,p));l.pos=n.add(h)}),a.onTouchEnd(g=>{g.x>e.width()*.6||u()}),a.onUpdate(()=>{if(!s)return;const p=o.scale(1/(i/2)).x;p<-r?(e.pressButton("left"),e.releaseButton("right")):p>r?(e.pressButton("right"),e.releaseButton("left")):(e.releaseButton("left"),e.releaseButton("right"))});function u(){s=!1,o=e.vec2(0,0),a.pos=e.vec2(-9999,-9999),l.pos=e.vec2(-9999,-9999),e.releaseButton("left"),e.releaseButton("right")}return a}class ys{constructor(t){this.k=t,this.dimOverlay=this.k.add([this.k.layer("hud"),this.k.rect(this.k.width(),this.k.height()),this.k.color(0,0,0),this.k.pos(0,0),this.k.anchor("topleft"),this.k.opacity(0),this.k.fixed(),this.k.stay()]),_.isTouchDevice()&&(this.joystick=ms(this.k,{size:Math.min(window.innerWidth/15,60)})),this.k.loadSprite("reload-button","sprites/icons/reload.png"),this.reloadButton=this.k.add(["reload-button",B({shouldBeShown:!0}),this.k.sprite("reload-button"),this.k.area(),this.k.pos(10,10),this.k.anchor("topleft")]),this.reloadButton.onClick(()=>{x.reset(),ye(this.k,Z.id,{isGameLevel:!0}).then()}),this.k.loadSprite("lucky-charm","sprites/icons/lucky-charm.gif",{sliceX:2,sliceY:1,anims:{health2:{from:0,to:0,loop:!1},health1:{from:1,to:1,loop:!1}}}),this.luckyCharm=this.k.add(["lucky-charm",B({shouldBeShown:x.state.persistent.player.hasLuckyCharm}),this.k.sprite("lucky-charm"),this.k.area(),this.k.pos(this.k.width()-10,10),this.k.anchor("topright"),this.k.scale(1)]),this.hide(),x.onUpdate(i=>this.onStateUpdate(i))}isShown=!1;dimOverlay;joystick;reloadButton;luckyCharm;show(){this.k.get("hud").forEach(t=>{t.shouldBeShown&&(this.k.tween(0,1,1,i=>{t.opacity=i*(t.targetOpacity??1)}),t.paused=!1)}),this.isShown=!0}hide(){this.k.get("hud").forEach(t=>{t.opacity=0,t.paused=!0}),this.isShown=!1,this.joystick?.releaseKnob()}async slightlyDimTheGame(){return this.k.tween(0,.4,.6,t=>{this.dimOverlay.opacity=t})}async slightlyUndimTheGame(){return this.k.tween(.4,0,.6,t=>{this.dimOverlay.opacity=t})}async onStateUpdate(t){if(t.persistent.player.hasLuckyCharm&&!this.luckyCharm.shouldBeShown){this.luckyCharm.shouldBeShown=!0,this.luckyCharm.paused=!1;const i=this.k.vec2(this.k.width()/2+10,this.k.height()/2-10),r=this.luckyCharm.pos.clone();this.luckyCharm.play("health2"),this.luckyCharm.pos=i.clone(),this.luckyCharm.scale=this.k.vec2(2),await this.slightlyDimTheGame(),await this.k.tween(0,1,1,s=>{this.luckyCharm.opacity=s}),await this.k.wait(1),this.k.play("player-take-key"),this.slightlyUndimTheGame().then(),await this.k.tween(0,1,1.5,s=>{this.luckyCharm.pos=this.k.vec2(this.k.lerp(i.x,r.x,s),this.k.lerp(i.y,r.y,s)),this.luckyCharm.scale=this.k.vec2(this.k.lerp(2,1,s))},this.k.easings.easeOutElastic)}!t.persistent.player.hasLuckyCharm&&this.luckyCharm.shouldBeShown&&(this.luckyCharm.shouldBeShown=!1,this.luckyCharm.paused=!0,this.luckyCharm.opacity=0),t.persistent.player.hasLuckyCharm&&t.temp.player.health&&this.luckyCharm.play("health"+t.temp.player.health)}}const bs={loading:"Loading...",rotateDevice:"Rotate your device",howToInstall:"How to install to the home screen?",notAllItemsFound:"Looks like I haven't collected everything yet..."},ws={intro1:"Hello, grandson! You finally bought your own hut... Even if it's with a mortgage, you're still doing great!",intro2:"It's a bit empty inside... But I saw some furniture nearby while I was walking here. You can look for it.",introRepeat1:"I saw some furniture nearby while I was walking here. You can look for it.",introRepeat2:"It's a nice day for a walk, don't you think?",introRepeat3:"The house won't furnish itself... Time to get to work!",giveLuckyCharm1:"Oh, I barely dragged you here... Are you okay?..",giveLuckyCharm2:"Ou, I almost forgot! Here, take this for good luck...",giveLuckyCharm3:"It's my lucky charm. May it protect you as it once protected me.",respawnInfo1:"If something happens to you, I'll always help you get back home.",respawnInfo2:"And don't worry about the things you've already collected  they won't disappear!"},Ss={kitchenTableRepeat1:"Hmm, who would throw away such a gorgeous table?..",kitchenTableRepeat2:"Mmm, it smells so good...",kitchenTableRepeat3:"Mmm, it looks so tasty... but I still need it.",kitchenChairRepeat1:"Why is it so small?.. Oh well, I don't have much choice.",bedRepeat1:"I'll sleep when I finish everything..."},xs={common:bs,oldBobr:ws,home:Ss},vs={loading:"...",rotateDevice:" ",howToInstall:"    ?",notAllItemsFound:",     ..."},Ls={intro1:", ! -    ...    ,     !",intro2:"  ...      ,   .    .",introRepeat1:"    ,   .    .",introRepeat2:"   ,   ?",introRepeat3:"    ...   !",giveLuckyCharm1:",     ...  ?..",giveLuckyCharm2:",  ! ,   ...",giveLuckyCharm3:"   .      -  .",respawnInfo1:"   - ,      .",respawnInfo2:"    ,        !"},Os={kitchenTableRepeat1:",     ?..",kitchenTableRepeat2:",   ...",kitchenTableRepeat3:",   ...     .",kitchenChairRepeat1:"   ?.. ,   .",bedRepeat1:" ,    ..."},Is={common:vs,oldBobr:Ls,home:Os},Ps=e=>{e.loadSprite("button-play","sprites/icons/play.png"),e.add(["button-play",e.layer("menu"),e.sprite("button-play",{width:100}),e.pos(e.width()/2,e.height()/2),e.anchor("center"),e.area(),e.fixed()]).onClick(()=>{ye(e,x.state.persistent.currentLevel||Z.id,{isGameLevel:!0,spawnAtExitIndex:x.state.persistent.spawnAtExitIndex}).then()})},Rs=e=>{e.loadSprite("rotate-device","sprites/icons/rotate-device.gif"),e.add(["rotate-device",e.sprite("rotate-device",{width:100}),e.anchor("bot"),e.pos(e.width()/2,e.height()/2-10),e.scale(e.vec2(-1,1)),e.fixed()]),e.add(["rotate-device-text",e.text(I("common.rotateDevice"),{font:"pixel",size:24,width:e.width()*.8,align:"center",lineSpacing:10}),e.color("white"),e.anchor("top"),e.pos(e.width()/2,e.height()/2+20),e.fixed()]);let t="https://www.cdc.gov/niosh/mining/tools/installpwa.html#cdc_generic_section_2-installing-a-pwa-on-ios";switch(P.language){case"ru":t="https://darkshaurma.com/about/pwa/";break}const i=document.createElement("a");i.href=t,i.target="_blank",i.rel="noopener",i.innerHTML=I("common.howToInstall"),i.style.position="absolute",i.style.width="100%",i.style.boxSizing="border-box",i.style.bottom="10%",i.style.left="0",i.style.display="block",i.style.padding="20px",i.style.color="white",i.style.fontFamily="pixel, monospace",i.style.textAlign="center",i.style.lineHeight="1.5em",document.querySelector("body").appendChild(i),e.onSceneLeave(()=>{document.querySelector("body").removeChild(i)})},x=new os,E=new ns(w);let fe,ge;(async()=>{await P.use(mt).init({supportedLngs:["en","ru"],fallbackLng:"ru",detection:{order:["localStorage","navigator"],caches:["localStorage"]},resources:{ru:{translation:Is},en:{translation:xs}}}),w.loadFont("pixel","fonts/Press_Start_2P/PressStart2P-Regular.ttf"),w.setLayers(["bg","game","hud","menu","fade"],"game"),w.add([w.layer("bg"),w.rect(w.width(),w.height()),w.color("#74dcf6"),w.pos(0,0),w.anchor("topleft"),w.fixed(),w.stay()]),w.setVolume(.5),fe=new ys(w),ge=new as(w),w.scene("menu",()=>Ps(w)),w.scene("rotate-device",()=>Rs(w)),w.scene(Z.id,Le(w,Z)),w.scene(q.id,Le(w,q)),w.scene(pe.id,Le(w,pe));const e=_.isLandscapeMode();window.addEventListener("resize",()=>{e||_.isLandscapeMode()!==e&&setTimeout(()=>{window.location.reload()},1e3)}),e?w.go("menu"):w.go("rotate-device")})();
